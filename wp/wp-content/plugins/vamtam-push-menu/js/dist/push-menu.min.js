!function(a){"use strict";if(Modernizr.touch){var b=null,c=null,d=!1,e=!1;window.WPVQuickTap=function(f){var g=this;f.on("touchstart",function(a){b=a.timeStamp,c=a.originalEvent.touches.item(0),d=!0,e=!1}),f.on("touchend",function(d){var f=d.timeStamp-b,h=g.getMovement(c,d.originalEvent.changedTouches.item(0)),i=!e&&5>h&&200>f;i&&(a(d.target).trigger("wpvQuickTap",d),d.preventDefault())}),f.on("scroll mousemove touchmove",function(a){"scroll"!==a.type&&"mousemove"!==a.type&&"touchmove"!==a.type||!d||e||(e=!0)})},WPVQuickTap.prototype.getMovement=function(a,b){if(!a||!b)return 0;var c=b.screenX-a.screenX,d=b.screenY-a.screenY;return Math.sqrt(c*c+d*d)}}}(jQuery),function(a,b){"use strict";function c(a,b){if(!a)return!1;for(var c=a.target||a.srcElement||a||!1;c&&c.id!==b;)c=c.parentNode||!1;return c!==!1}function d(a,c,e,f){return f=f||0,a.id.indexOf(c)>=0?f:(b(a).hasClass(e)&&++f,a.parentNode&&d(a.parentNode,c,e,f))}function e(c,d,e){var f=this;this.el=c,this.trigger=d,this.options=b.extend(this.defaults,e),(Modernizr.csstransforms3d||Modernizr.csstransforms)&&(this._init(),b(a).bind("resize",function(){b(a).width()>767&&f._resetMenu(!0)}))}function f(a){return Modernizr.csstransforms3d?"translate3d("+a+",0,0)":"translateX("+a+")"}(Modernizr.csstransforms3d||Modernizr.csstransforms)&&(e.prototype={defaults:{type:"overlap",levelSpacing:40,backClass:"mp-back"},_init:function(){this.open=!1,this.level=0,this.wrapper=document.getElementById("mp-pusher"),this.levels=Array.prototype.slice.call(this.el.querySelectorAll("div.mp-level"));var a=this;this.levels.forEach(function(b){b.setAttribute("data-level",d(b,a.el.id,"mp-level"))}),this.menuItems=Array.prototype.slice.call(this.el.querySelectorAll("li")),this.levelBack=Array.prototype.slice.call(this.el.querySelectorAll("."+this.options.backClass)),this.eventtype=Modernizr.touch?"wpvQuickTap":"click",b(this.el).addClass("mp-"+this.options.type),this._initEvents()},_initEvents:function(){var a=this,d=function(c){a._resetMenu(),b(c).unbind(a.eventtype,d)};this.trigger.bind(this.eventtype,function(e){e.stopPropagation(),e.preventDefault(),a.open?a._resetMenu():(a._openMenu(),b(document).bind(a.eventtype,function(b){a.open&&!c(b.target,a.el.id)&&d(this)}))}),this.menuItems.forEach(function(c){var d=c.querySelector("div.mp-level");d&&b("a",c).bind(a.eventtype,function(e){var f=b(c).closest(".mp-level").data("level");a.level<=f&&(e.preventDefault(),e.stopPropagation(),b(c).closest(".mp-level").addClass("mp-level-overlay"),a._openMenu(d))})}),this.levels.forEach(function(c){b(c).bind(a.eventtype,function(b){b.stopPropagation();var d=c.getAttribute("data-level");a.level>d&&(a.level=d,a._closeMenu())})}),this.levelBack.forEach(function(c){b(c).bind(a.eventtype,function(d){d.preventDefault();var e=b(c).closest(".mp-level").data("level");a.level<=e&&(d.stopPropagation(),a.level=b(c).closest(".mp-level").data("level")-1,0===a.level?a._resetMenu():a._closeMenu())})})},_openMenu:function(a){++this.level;var c=(this.level-1)*this.options.levelSpacing,d="overlap"===this.options.type?this.el.offsetWidth+c:this.el.offsetWidth;if(b(this.wrapper).css("transform",f(d+"px")),a&&(b(a).css("transform",""),this.levels&&this.levels.length))for(var e=0,g=this.levels.length;g>e;++e){var h=this.levels[e];h===a||b(h).hasClass("mp-level-open")||(h.style.WebkitTransform=h.style.transform=f("-100%")+" "+f(-1*c+"px"))}1===this.level&&(b(this.wrapper).addClass("mp-pushed"),this.open=!0),b(a||this.levels[0]).addClass("mp-level-open")},_resetMenu:function(c){b(this.wrapper).css("transform","none"),this.level=0,b(this.wrapper).removeClass("mp-pushed"),this._toggleLevels(),this.open=!1,c||(b(a).resize(),setTimeout(function(){b(a).resize()},500))},_closeMenu:function(){var a="overlap"===this.options.type?this.el.offsetWidth+(this.level-1)*this.options.levelSpacing:this.el.offsetWidth;b(this.wrapper).css("transform",f(a+"px")),this._toggleLevels()},_toggleLevels:function(){var a=this;_.each(this.levels,function(c){c=b(c),c.data("level")>=a.level+1?c.removeClass("mp-level-open mp-level-overlay"):Number(c.data("level"))===a.level&&c.removeClass("mp-level-overlay")})}},a.MlPushMenu=e)}(window,jQuery),function(a){"use strict";if(Modernizr.csstransforms3d||Modernizr.csstransforms){var b={Models:{},Collections:{},Views:{}};b.Models.Root=Backbone.Model.extend({defaults:{title:"",description:"",type:"root",children:[]},initialize:function(){this.children=new b.Collections.Item}}),b.Models.Item=Backbone.Model.extend({defaults:{url:"",title:"",attr_title:"",description:"",classes:[],type:"root",children:[]}}),b.Collections.Item=Backbone.Collection.extend({model:b.Models.Item}),b.Collections.Root=Backbone.Collection.extend({model:b.Models.Root}),b.Views.Root=Backbone.View.extend({el:a("#container"),initialize:function(){this.template=a("#wpvpm-menu-root").html(),_.bindAll(this,"render"),this.listenTo(this.model,"change",this.render),this.render()},render:function(){var c=new b.Views.Item({model:new b.Models.Item(this.model.toJSON())}).render(),d=a("<div></div>").addClass("scroller").attr("id","mp-scroller"),e=a("<div></div>").addClass("mp-pusher").attr("id","mp-pusher");a(this.el).wrap(e).before(_.template(this.template)({content:c})),a(this.el).wrap(d)}}),b.Views.Item=Backbone.View.extend({initialize:function(){this.template=a("#wpvpm-menu-item").html(),_.bindAll(this,"render")},render:function(){var a="";return _(this.model.get("children")).each(function(c){var d=new b.Views.Item({model:new b.Models.Item(c)});a+=d.render()}),_.template(this.template)(_.extend(this.model.toJSON(),{content:a}))}}),a(function(){if("WpvPushMenu"in window&&WpvPushMenu.items){new b.Views.Root({model:new b.Models.Root(WpvPushMenu.items)});var c=a("#mp-menu-trigger");c&&(new MlPushMenu(document.getElementById("mp-menu"),c,{type:"cover"}),"WPVQuickTap"in window&&new WPVQuickTap(a("#mp-menu .mp-back, #mp-menu .has-children, #mp-menu-trigger")))}})}}(jQuery);